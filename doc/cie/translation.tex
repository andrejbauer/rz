\section{Translation}
\label{sec:translation}

Having seen the input and output languages for RZ, we now explain how
the translation from one to the other works. The mathematical basis
for the translation procedure is the \emph{realizability
  interpretation} of constructive type theory and logic in the
category of modest sets, which was described in
Section~\ref{sec:modest-sets-pers}. A theory is translated to a
specification, where the theory elements are translated as follows.

A set declaration $\iParameter{s}{\iSet}$ is translated to
%
\begin{align*}
  & \otyspec{s}. \\
  & \opropspec{({\approx_{s}})}{\oarrow{s}{\oarrow{s}{\oProp}}}.\\
  & \oassertion{\mathrm{per}_{s}}{
    \begin{aligned}[t]
      & \oforall{x\,y}{s}{(\oimply{\oper{s}{x}{y}}{\oper{s}{y}{x}})}
        \land {} \\
      & \oforall{x\,y\,z}{s}{(
        \oimply{
          \oper{s}{x}{y} \land \oper{s}{y}{z}
          }{\oper{s}{x}{z}}
        )}.
    \end{aligned}
  }
\end{align*}
%
This says that the programmer should define a type~$s$, and a binary
predicate~$\approx_s$ on $\values{s}$ which is symmetric and
transitive.\footnote{The predicate is \emph{not} an ocaml value of
  type $s \to s \to \mathtt{bool}$, but an abstract relation on the
  set $\values{s} \times \values{s}$. Only in special cases can we
  implement the per as a decidable test.} When a dependent set is
declared in the input, e.g., $\iParameter{t}{s \to \iSet}$, the
translation follows the interpretation of dependent sets as uniform
families, cf.\ Section~\ref{sec:uniform-families}. The underlying
output type is still non-dependent, but the per
$\approx_{\oapp{t}{{-}}}$ is parametrized by~$s$, so it is declared to
have type $\oarrow{s}{\oarrow{t}{\oarrow{t}{\oProp}}}$.

An element declaration $\iParameter{x}{s}$ is translated to
%
\begin{align*}
  & \ovalspec{x}{s} \\
  & \oassertion{\mathrm{support}_x}{\ototal{x}{s}}
\end{align*}
%
which requires the definition of a value~$x$ of type~$s$ which is in
the support of~$s$. When $s$ is not a basic set, RZ computes the
interpretation of the underlying type and support.

Constructions of sets in the input language are translated to
corresponding constructions of modest sets. In
Section~\ref{sec:modest-sets-pers} we saw how products, exponentials
and their dependent versions are formed. We briefly review the
remaining constructions. A disjoint union
$t = \isum{\il_1}{\is_1}{\il_2}{\is_2}$ is translated to the variant type
$t = \osumtyx{\il_1}{\is_1}{\il_2}{\is_2}$ with the per
%
\begin{align*}
  \oper{t}{\oinj{\il_1}{u}}{\oinj{\il_1}{v}} &\iff \oper{s_1}{u}{v},
  \\
  \oper{t}{\oinj{\il_2}{u}}{\oinj{\il_2}{v}} &\iff \oper{s_2}{u}{v}.
\end{align*}
%

quotient

subsets

rz

Propositions and axioms.

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "cie"
%%% End: 
